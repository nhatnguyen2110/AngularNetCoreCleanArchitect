2022-03-11 15:39:58.931 +07:00 [INF] Starting Duende IdentityServer version 5.2.0+1c3f1fadb0fa7a4bea3f4a6f7028cbfcff3b9918 (.NET 6.0.1)
2022-03-11 15:39:59.614 +07:00 [WRN] You do not have a valid license key for Duende IdentityServer. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please start a conversation with us: https://duendesoftware.com/contact
2022-03-11 15:40:00.713 +07:00 [INF] Using explicitly configured authentication scheme Identity.Application for IdentityServer
2022-03-11 15:40:00.713 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for authentication
2022-03-11 15:40:00.715 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2022-03-11 15:40:00.716 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2022-03-11 15:40:00.716 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for challenge
2022-03-11 15:40:00.717 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for forbid
2022-03-11 15:40:02.075 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2022-03-11 15:40:02.076 +07:00 [INF] Hosting environment: Development
2022-03-11 15:40:02.076 +07:00 [INF] Content root path: D:\My Projects\Clean-Architecture\CleanArchitecture-main\src\WebUI
2022-03-11 15:40:03.175 +07:00 [DBG] Login Url: /Identity/Account/Login
2022-03-11 15:40:03.179 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2022-03-11 15:40:03.179 +07:00 [DBG] Logout Url: /Identity/Account/Logout
2022-03-11 15:40:03.179 +07:00 [DBG] ConsentUrl Url: /consent
2022-03-11 15:40:03.179 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2022-03-11 15:40:03.179 +07:00 [DBG] Error Url: /Home
2022-03-11 15:40:03.179 +07:00 [DBG] Error Id Parameter: errorId
2022-03-11 15:41:43.912 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2022-03-11 15:41:44.240 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: Duende.IdentityServer.Endpoints.DiscoveryEndpoint
2022-03-11 15:41:44.242 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-03-11 15:41:44.245 +07:00 [DBG] Start discovery request
2022-03-11 15:41:44.303 +07:00 [DBG] Getting all the keys.
2022-03-11 15:41:44.312 +07:00 [DBG] Cache miss when loading all keys.
2022-03-11 15:41:44.320 +07:00 [DBG] Loading keys from store.
2022-03-11 15:41:44.694 +07:00 [DBG] Keys successfully returned from store.
2022-03-11 15:41:44.699 +07:00 [DBG] Caching keys with KeyCacheDuration for "1.00:00:00"
2022-03-11 15:41:44.715 +07:00 [DBG] Looking for active signing keys.
2022-03-11 15:41:44.716 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-03-11 15:41:44.725 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:44.725 +07:00 [DBG] Found active signing key for alg RS256 with kid 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:44.736 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:44.737 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "58.19:12:35"
2022-03-11 15:41:44.785 +07:00 [DBG] Getting the current key.
2022-03-11 15:41:44.786 +07:00 [DBG] Cache hit when loading all keys.
2022-03-11 15:41:44.786 +07:00 [DBG] Looking for active signing keys.
2022-03-11 15:41:44.786 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-03-11 15:41:44.786 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:44.786 +07:00 [DBG] Found active signing key for alg RS256 with kid 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:44.786 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:44.787 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "58.19:12:35"
2022-03-11 15:41:44.787 +07:00 [INF] Active signing key found with kid 4EC832F91DDF6A8CD3CDFFF491EBA14C for alg RS256. Expires in "72.19:12:35". Retires in "86.19:12:35"
2022-03-11 15:41:44.847 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2022-03-11 15:41:44.858 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2022-03-11 15:41:44.859 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2022-03-11 15:41:44.863 +07:00 [DBG] Start authorize request
2022-03-11 15:41:44.893 +07:00 [DBG] User in authorize request: 21e5069d-a790-49de-8b3b-3cc4584d9470
2022-03-11 15:41:45.169 +07:00 [DBG] Start authorize request protocol validation
2022-03-11 15:41:45.201 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 15:41:45.230 +07:00 [DBG] Checking for PKCE parameters
2022-03-11 15:41:45.295 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-03-11 15:41:45.331 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"3b431e63ca54464aa56192b11dbbf6a1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"73632BDFA38B1AA4D88ADC0CF580F5E9","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"3b431e63ca54464aa56192b11dbbf6a1","code_challenge":"D-n9cfpxsDAF4yyKZvnLmNmtuO8kTW5jRJnePsl5alk","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-03-11 15:41:45.432 +07:00 [DBG] Client is configured to not require consent, no consent is required
2022-03-11 15:41:45.439 +07:00 [DBG] Creating Authorization Code Flow response.
2022-03-11 15:41:45.517 +07:00 [DBG] BM/aUnx9IUnUZSfrnHNOjNXYPJU5JITxOCksukNuOpw= not found in database
2022-03-11 15:41:46.732 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","Endpoint":"Authorize","SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****79B2","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"800001af-0000-fe00-b63f-84710c7967bb","TimeStamp":"2022-03-11T08:41:46.0000000Z","ProcessId":7068,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-03-11 15:41:46.736 +07:00 [DBG] Authorize endpoint response
{"SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","ClientId":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","State":"3b431e63ca54464aa56192b11dbbf6a1","Scope":"CleanArchitecture.WebUIAPI openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2022-03-11 15:41:49.751 +07:00 [DBG] Request path /connect/token matched to endpoint type Token
2022-03-11 15:41:49.759 +07:00 [DBG] Endpoint enabled: Token, successfully created handler: Duende.IdentityServer.Endpoints.TokenEndpoint
2022-03-11 15:41:49.759 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.TokenEndpoint for /connect/token
2022-03-11 15:41:49.771 +07:00 [DBG] Start token request.
2022-03-11 15:41:49.777 +07:00 [DBG] Start client validation
2022-03-11 15:41:49.788 +07:00 [DBG] Start parsing Basic Authentication secret
2022-03-11 15:41:49.791 +07:00 [DBG] Start parsing for secret in post body
2022-03-11 15:41:49.809 +07:00 [DBG] client id without secret found
2022-03-11 15:41:49.810 +07:00 [DBG] Parser found secret: PostBodySecretParser
2022-03-11 15:41:49.810 +07:00 [DBG] Secret id found: CleanArchitecture.WebUI
2022-03-11 15:41:49.811 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 15:41:49.811 +07:00 [DBG] Public Client - skipping secret validation success
2022-03-11 15:41:49.812 +07:00 [DBG] Client validation success
2022-03-11 15:41:49.814 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"800000dd-0001-fe00-b63f-84710c7967bb","TimeStamp":"2022-03-11T08:41:49.0000000Z","ProcessId":7068,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-03-11 15:41:49.821 +07:00 [DBG] Start token request validation
2022-03-11 15:41:49.832 +07:00 [DBG] Start validation of authorization code token request
2022-03-11 15:41:49.884 +07:00 [DBG] BM/aUnx9IUnUZSfrnHNOjNXYPJU5JITxOCksukNuOpw= found in database: true
2022-03-11 15:41:49.931 +07:00 [DBG] removing BM/aUnx9IUnUZSfrnHNOjNXYPJU5JITxOCksukNuOpw= persisted grant from database
2022-03-11 15:41:50.009 +07:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2022-03-11 15:41:50.021 +07:00 [DBG] Validation of authorization code token request success
2022-03-11 15:41:50.029 +07:00 [INF] Token request validation success, {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****79B2","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"CleanArchitecture.WebUI","code":"3FC2A8F3C526EFE10D7E9D3044474546CB7CA0A39B700D08B9C0BE433D5A79B2","redirect_uri":"https://localhost:44312/authentication/login-callback","code_verifier":"017f7bd7c22442a49ba03abaf532adba1cbde7a7cf1348589ca3a082638ed7ac9b591d837ee94323bb6e85ef04df6842","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2022-03-11 15:41:50.044 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 15:41:50.074 +07:00 [DBG] Getting claims for access token for client: CleanArchitecture.WebUI
2022-03-11 15:41:50.075 +07:00 [DBG] Getting claims for access token for subject: 21e5069d-a790-49de-8b3b-3cc4584d9470
2022-03-11 15:41:50.587 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 15:41:50.602 +07:00 [DBG] Getting claims for identity token for subject: 21e5069d-a790-49de-8b3b-3cc4584d9470 and client: CleanArchitecture.WebUI
2022-03-11 15:41:50.602 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2022-03-11 15:41:50.611 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":null,"Endpoint":"Token","SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****pDtA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****MfhQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"800000dd-0001-fe00-b63f-84710c7967bb","TimeStamp":"2022-03-11T08:41:50.0000000Z","ProcessId":7068,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-03-11 15:41:50.613 +07:00 [DBG] Token request success.
2022-03-11 15:41:50.808 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2022-03-11 15:41:50.810 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: Duende.IdentityServer.Endpoints.UserInfoEndpoint
2022-03-11 15:41:50.811 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-03-11 15:41:50.816 +07:00 [DBG] Start userinfo request
2022-03-11 15:41:50.820 +07:00 [DBG] Bearer token found in header
2022-03-11 15:41:50.831 +07:00 [DBG] Getting all the keys.
2022-03-11 15:41:50.831 +07:00 [DBG] Cache hit when loading all keys.
2022-03-11 15:41:50.831 +07:00 [DBG] Looking for active signing keys.
2022-03-11 15:41:50.831 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-03-11 15:41:50.832 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:50.832 +07:00 [DBG] Found active signing key for alg RS256 with kid 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:50.832 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 15:41:50.832 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "58.19:12:29"
2022-03-11 15:41:50.896 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 15:41:50.902 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 15:41:50.915 +07:00 [DBG] Calling into custom token validator: Duende.IdentityServer.Validation.DefaultCustomTokenValidator
2022-03-11 15:41:50.917 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"AF319B0CC4BFEDCBDCD94F9536CE5723","Claims":{"iss":"https://localhost:44312","nbf":1646988110,"iat":1646988110,"exp":1646991710,"aud":"CleanArchitecture.WebUIAPI","scope":["CleanArchitecture.WebUIAPI","openid","profile"],"amr":"pwd","client_id":"CleanArchitecture.WebUI","sub":"21e5069d-a790-49de-8b3b-3cc4584d9470","auth_time":1645502403,"idp":"local","sid":"73632BDFA38B1AA4D88ADC0CF580F5E9","jti":"AF319B0CC4BFEDCBDCD94F9536CE5723"},"$type":"TokenValidationLog"}
2022-03-11 15:41:50.929 +07:00 [DBG] Creating userinfo response
2022-03-11 15:41:50.933 +07:00 [DBG] Scopes in access token: CleanArchitecture.WebUIAPI openid profile
2022-03-11 15:41:50.939 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2022-03-11 15:41:50.951 +07:00 [INF] Profile service returned the following claim types: sub preferred_username name
2022-03-11 15:41:50.951 +07:00 [DBG] End userinfo request
2022-03-11 15:41:50.985 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2022-03-11 15:41:50.986 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: Duende.IdentityServer.Endpoints.CheckSessionEndpoint
2022-03-11 15:41:50.986 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.CheckSessionEndpoint for /connect/checksession
2022-03-11 15:41:50.987 +07:00 [DBG] Rendering check session result
2022-03-11 15:42:35.219 +07:00 [INF] Request: GetWeatherConditionQuery 21e5069d-a790-49de-8b3b-3cc4584d9470 minhnhat2110.hcm06@gmail.com {"$type":"GetWeatherConditionQuery"}
2022-03-11 16:07:42.259 +07:00 [INF] Starting Duende IdentityServer version 5.2.0+1c3f1fadb0fa7a4bea3f4a6f7028cbfcff3b9918 (.NET 6.0.1)
2022-03-11 16:07:42.516 +07:00 [WRN] You do not have a valid license key for Duende IdentityServer. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please start a conversation with us: https://duendesoftware.com/contact
2022-03-11 16:07:43.130 +07:00 [INF] Using explicitly configured authentication scheme Identity.Application for IdentityServer
2022-03-11 16:07:43.131 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for authentication
2022-03-11 16:07:43.131 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2022-03-11 16:07:43.132 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2022-03-11 16:07:43.133 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for challenge
2022-03-11 16:07:43.133 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for forbid
2022-03-11 16:07:44.158 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2022-03-11 16:07:44.159 +07:00 [INF] Hosting environment: Development
2022-03-11 16:07:44.159 +07:00 [INF] Content root path: D:\My Projects\Clean-Architecture\CleanArchitecture-main\src\WebUI
2022-03-11 16:07:44.743 +07:00 [DBG] Login Url: /Identity/Account/Login
2022-03-11 16:07:44.747 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2022-03-11 16:07:44.747 +07:00 [DBG] Logout Url: /Identity/Account/Logout
2022-03-11 16:07:44.747 +07:00 [DBG] ConsentUrl Url: /consent
2022-03-11 16:07:44.747 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2022-03-11 16:07:44.748 +07:00 [DBG] Error Url: /Home
2022-03-11 16:07:44.748 +07:00 [DBG] Error Id Parameter: errorId
2022-03-11 16:10:20.517 +07:00 [INF] Request: GetWeatherForecastIn7daysQuery   {"ProvinceId":131,"$type":"GetWeatherForecastIn7daysQuery"}
2022-03-11 16:10:21.716 +07:00 [INF] Start processing HTTP request GET "https://api.openweathermap.org/data/2.5/onecall?appid=baaaee5bb441159c6d293745bf6566ba&lat=10.8&lon=106.65&exclude=minutely&units=metric"
2022-03-11 16:10:21.809 +07:00 [INF] Sending HTTP request GET "https://api.openweathermap.org/data/2.5/onecall?appid=baaaee5bb441159c6d293745bf6566ba&lat=10.8&lon=106.65&exclude=minutely&units=metric"
2022-03-11 16:10:22.419 +07:00 [INF] Received HTTP response headers after 594.0962ms - 200
2022-03-11 16:10:22.434 +07:00 [INF] End processing HTTP request after 730.8649ms - 200
2022-03-11 16:22:58.622 +07:00 [INF] Starting Duende IdentityServer version 5.2.0+1c3f1fadb0fa7a4bea3f4a6f7028cbfcff3b9918 (.NET 6.0.1)
2022-03-11 16:22:58.890 +07:00 [WRN] You do not have a valid license key for Duende IdentityServer. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please start a conversation with us: https://duendesoftware.com/contact
2022-03-11 16:22:59.569 +07:00 [INF] Using explicitly configured authentication scheme Identity.Application for IdentityServer
2022-03-11 16:22:59.570 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for authentication
2022-03-11 16:22:59.571 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2022-03-11 16:22:59.571 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2022-03-11 16:22:59.572 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for challenge
2022-03-11 16:22:59.573 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for forbid
2022-03-11 16:23:00.627 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2022-03-11 16:23:00.627 +07:00 [INF] Hosting environment: Development
2022-03-11 16:23:00.627 +07:00 [INF] Content root path: D:\My Projects\Clean-Architecture\CleanArchitecture-main\src\WebUI
2022-03-11 16:23:01.273 +07:00 [DBG] Login Url: /Identity/Account/Login
2022-03-11 16:23:01.277 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2022-03-11 16:23:01.277 +07:00 [DBG] Logout Url: /Identity/Account/Logout
2022-03-11 16:23:01.277 +07:00 [DBG] ConsentUrl Url: /consent
2022-03-11 16:23:01.278 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2022-03-11 16:23:01.278 +07:00 [DBG] Error Url: /Home
2022-03-11 16:23:01.278 +07:00 [DBG] Error Id Parameter: errorId
2022-03-11 16:23:25.415 +07:00 [INF] Request: GetWeatherForecastIn7daysQuery   {"ProvinceId":131,"$type":"GetWeatherForecastIn7daysQuery"}
2022-03-11 16:23:26.633 +07:00 [INF] Start processing HTTP request GET "https://api.openweathermap.org/data/2.5/onecall?appid=baaaee5bb441159c6d293745bf6566ba&lat=10.8&lon=106.65&exclude=minutely&units=metric"
2022-03-11 16:23:26.692 +07:00 [INF] Sending HTTP request GET "https://api.openweathermap.org/data/2.5/onecall?appid=baaaee5bb441159c6d293745bf6566ba&lat=10.8&lon=106.65&exclude=minutely&units=metric"
2022-03-11 16:23:27.134 +07:00 [INF] Received HTTP response headers after 426.9358ms - 200
2022-03-11 16:23:27.151 +07:00 [INF] End processing HTTP request after 531.9811ms - 200
2022-03-11 16:25:20.754 +07:00 [INF] Request: GetWeatherForecastIn7daysQuery   {"ProvinceId":131,"$type":"GetWeatherForecastIn7daysQuery"}
2022-03-11 16:25:49.846 +07:00 [INF] Request: GetWeatherForecastIn7daysQuery   {"ProvinceId":132,"$type":"GetWeatherForecastIn7daysQuery"}
2022-03-11 16:25:49.871 +07:00 [INF] Start processing HTTP request GET "https://api.openweathermap.org/data/2.5/onecall?appid=baaaee5bb441159c6d293745bf6566ba&lat=10.5&lon=105.167&exclude=minutely&units=metric"
2022-03-11 16:25:49.871 +07:00 [INF] Sending HTTP request GET "https://api.openweathermap.org/data/2.5/onecall?appid=baaaee5bb441159c6d293745bf6566ba&lat=10.5&lon=105.167&exclude=minutely&units=metric"
2022-03-11 16:25:50.129 +07:00 [INF] Received HTTP response headers after 257.418ms - 200
2022-03-11 16:25:50.130 +07:00 [INF] End processing HTTP request after 258.8926ms - 200
2022-03-11 16:26:16.627 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2022-03-11 16:26:17.218 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: Duende.IdentityServer.Endpoints.DiscoveryEndpoint
2022-03-11 16:26:17.220 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-03-11 16:26:17.224 +07:00 [DBG] Start discovery request
2022-03-11 16:26:17.283 +07:00 [DBG] Getting all the keys.
2022-03-11 16:26:17.291 +07:00 [DBG] Cache miss when loading all keys.
2022-03-11 16:26:17.296 +07:00 [DBG] Loading keys from store.
2022-03-11 16:26:17.773 +07:00 [DBG] Keys successfully returned from store.
2022-03-11 16:26:17.777 +07:00 [DBG] Caching keys with KeyCacheDuration for "1.00:00:00"
2022-03-11 16:26:17.785 +07:00 [DBG] Looking for active signing keys.
2022-03-11 16:26:17.786 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-03-11 16:26:17.793 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:17.794 +07:00 [DBG] Found active signing key for alg RS256 with kid 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:17.802 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:17.803 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "58.18:28:02"
2022-03-11 16:26:17.868 +07:00 [DBG] Getting the current key.
2022-03-11 16:26:17.868 +07:00 [DBG] Cache hit when loading all keys.
2022-03-11 16:26:17.869 +07:00 [DBG] Looking for active signing keys.
2022-03-11 16:26:17.869 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-03-11 16:26:17.869 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:17.869 +07:00 [DBG] Found active signing key for alg RS256 with kid 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:17.870 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:17.870 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "58.18:28:02"
2022-03-11 16:26:17.871 +07:00 [INF] Active signing key found with kid 4EC832F91DDF6A8CD3CDFFF491EBA14C for alg RS256. Expires in "72.18:28:02". Retires in "86.18:28:02"
2022-03-11 16:26:17.936 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2022-03-11 16:26:17.959 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2022-03-11 16:26:17.960 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2022-03-11 16:26:17.963 +07:00 [DBG] Start authorize request
2022-03-11 16:26:17.984 +07:00 [DBG] User in authorize request: 21e5069d-a790-49de-8b3b-3cc4584d9470
2022-03-11 16:26:18.027 +07:00 [DBG] Start authorize request protocol validation
2022-03-11 16:26:18.059 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 16:26:18.092 +07:00 [DBG] Checking for PKCE parameters
2022-03-11 16:26:18.172 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-03-11 16:26:18.197 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"ec32703453c04cdeba084f3495ca5c3f","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"73632BDFA38B1AA4D88ADC0CF580F5E9","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"ec32703453c04cdeba084f3495ca5c3f","code_challenge":"CZg0Jza2Xbc0IjoWEyT8unx7izWUoeeeEwjdC8ivorQ","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-03-11 16:26:18.453 +07:00 [DBG] Client is configured to not require consent, no consent is required
2022-03-11 16:26:18.461 +07:00 [DBG] Creating Authorization Code Flow response.
2022-03-11 16:26:18.567 +07:00 [DBG] 73vP4qeZaiaFlhprpaE3iRPihmSJsBuctJb+sWdV71w= not found in database
2022-03-11 16:26:19.163 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","Endpoint":"Authorize","SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****68EA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000013c-0000-fb00-b63f-84710c7967bb","TimeStamp":"2022-03-11T09:26:19.0000000Z","ProcessId":16280,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-03-11 16:26:19.168 +07:00 [DBG] Authorize endpoint response
{"SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","ClientId":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","State":"ec32703453c04cdeba084f3495ca5c3f","Scope":"CleanArchitecture.WebUIAPI openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2022-03-11 16:26:22.509 +07:00 [DBG] Request path /connect/token matched to endpoint type Token
2022-03-11 16:26:22.515 +07:00 [DBG] Endpoint enabled: Token, successfully created handler: Duende.IdentityServer.Endpoints.TokenEndpoint
2022-03-11 16:26:22.515 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.TokenEndpoint for /connect/token
2022-03-11 16:26:22.525 +07:00 [DBG] Start token request.
2022-03-11 16:26:22.531 +07:00 [DBG] Start client validation
2022-03-11 16:26:22.542 +07:00 [DBG] Start parsing Basic Authentication secret
2022-03-11 16:26:22.546 +07:00 [DBG] Start parsing for secret in post body
2022-03-11 16:26:22.566 +07:00 [DBG] client id without secret found
2022-03-11 16:26:22.568 +07:00 [DBG] Parser found secret: PostBodySecretParser
2022-03-11 16:26:22.568 +07:00 [DBG] Secret id found: CleanArchitecture.WebUI
2022-03-11 16:26:22.569 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 16:26:22.569 +07:00 [DBG] Public Client - skipping secret validation success
2022-03-11 16:26:22.569 +07:00 [DBG] Client validation success
2022-03-11 16:26:22.572 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000097-0005-fb00-b63f-84710c7967bb","TimeStamp":"2022-03-11T09:26:22.0000000Z","ProcessId":16280,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-03-11 16:26:22.581 +07:00 [DBG] Start token request validation
2022-03-11 16:26:22.596 +07:00 [DBG] Start validation of authorization code token request
2022-03-11 16:26:22.651 +07:00 [DBG] 73vP4qeZaiaFlhprpaE3iRPihmSJsBuctJb+sWdV71w= found in database: true
2022-03-11 16:26:22.693 +07:00 [DBG] removing 73vP4qeZaiaFlhprpaE3iRPihmSJsBuctJb+sWdV71w= persisted grant from database
2022-03-11 16:26:22.758 +07:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2022-03-11 16:26:22.770 +07:00 [DBG] Validation of authorization code token request success
2022-03-11 16:26:22.779 +07:00 [INF] Token request validation success, {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****68EA","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"CleanArchitecture.WebUI","code":"B71FAF4376D07F29A2ADAD0416FECAFD8EE393479907AAA015C3D5638E5568EA","redirect_uri":"https://localhost:44312/authentication/login-callback","code_verifier":"faddfd4c64dc47ee9600181e4883c08a0ad314d40b20477baba9f2e051f64d995196c719150c4aeb8bd65caa0786eb8b","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2022-03-11 16:26:22.799 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 16:26:22.829 +07:00 [DBG] Getting claims for access token for client: CleanArchitecture.WebUI
2022-03-11 16:26:22.830 +07:00 [DBG] Getting claims for access token for subject: 21e5069d-a790-49de-8b3b-3cc4584d9470
2022-03-11 16:26:23.746 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 16:26:23.761 +07:00 [DBG] Getting claims for identity token for subject: 21e5069d-a790-49de-8b3b-3cc4584d9470 and client: CleanArchitecture.WebUI
2022-03-11 16:26:23.762 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2022-03-11 16:26:23.772 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":null,"Endpoint":"Token","SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****WZ2g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****OlZA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000097-0005-fb00-b63f-84710c7967bb","TimeStamp":"2022-03-11T09:26:23.0000000Z","ProcessId":16280,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-03-11 16:26:23.773 +07:00 [DBG] Token request success.
2022-03-11 16:26:24.002 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2022-03-11 16:26:24.006 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: Duende.IdentityServer.Endpoints.UserInfoEndpoint
2022-03-11 16:26:24.006 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-03-11 16:26:24.016 +07:00 [DBG] Start userinfo request
2022-03-11 16:26:24.023 +07:00 [DBG] Bearer token found in header
2022-03-11 16:26:24.035 +07:00 [DBG] Getting all the keys.
2022-03-11 16:26:24.035 +07:00 [DBG] Cache hit when loading all keys.
2022-03-11 16:26:24.035 +07:00 [DBG] Looking for active signing keys.
2022-03-11 16:26:24.035 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-03-11 16:26:24.036 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:24.036 +07:00 [DBG] Found active signing key for alg RS256 with kid 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:24.036 +07:00 [DBG] Active signing key found (respecting the activation delay) with kid: 4EC832F91DDF6A8CD3CDFFF491EBA14C.
2022-03-11 16:26:24.036 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "58.18:27:55"
2022-03-11 16:26:24.102 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 16:26:24.108 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-03-11 16:26:24.120 +07:00 [DBG] Calling into custom token validator: Duende.IdentityServer.Validation.DefaultCustomTokenValidator
2022-03-11 16:26:24.122 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EBD0F43B903E5C39E2CA1A68ABB0B039","Claims":{"iss":"https://localhost:44312","nbf":1646990783,"iat":1646990783,"exp":1646994383,"aud":"CleanArchitecture.WebUIAPI","scope":["CleanArchitecture.WebUIAPI","openid","profile"],"amr":"pwd","client_id":"CleanArchitecture.WebUI","sub":"21e5069d-a790-49de-8b3b-3cc4584d9470","auth_time":1645502403,"idp":"local","sid":"73632BDFA38B1AA4D88ADC0CF580F5E9","jti":"EBD0F43B903E5C39E2CA1A68ABB0B039"},"$type":"TokenValidationLog"}
2022-03-11 16:26:24.137 +07:00 [DBG] Creating userinfo response
2022-03-11 16:26:24.142 +07:00 [DBG] Scopes in access token: CleanArchitecture.WebUIAPI openid profile
2022-03-11 16:26:24.151 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2022-03-11 16:26:24.181 +07:00 [INF] Profile service returned the following claim types: sub preferred_username name
2022-03-11 16:26:24.181 +07:00 [DBG] End userinfo request
2022-03-11 16:26:24.221 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2022-03-11 16:26:24.222 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: Duende.IdentityServer.Endpoints.CheckSessionEndpoint
2022-03-11 16:26:24.223 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.CheckSessionEndpoint for /connect/checksession
2022-03-11 16:26:24.225 +07:00 [DBG] Rendering check session result
2022-03-11 16:26:44.093 +07:00 [INF] Request: GetWeatherConditionQuery 21e5069d-a790-49de-8b3b-3cc4584d9470 minhnhat2110.hcm06@gmail.com {"$type":"GetWeatherConditionQuery"}
2022-03-11 16:27:07.662 +07:00 [INF] Request: GetProvincesWithPaginationQuery 21e5069d-a790-49de-8b3b-3cc4584d9470 minhnhat2110.hcm06@gmail.com {"Keyword":null,"PageNumber":1,"PageSize":99,"$type":"GetProvincesWithPaginationQuery"}
