2022-05-24 11:16:47.184 +07:00 [INF] Starting Duende IdentityServer version 5.2.0+1c3f1fadb0fa7a4bea3f4a6f7028cbfcff3b9918 (.NET 6.0.3)
2022-05-24 11:16:48.012 +07:00 [WRN] You do not have a valid license key for Duende IdentityServer. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please start a conversation with us: https://duendesoftware.com/contact
2022-05-24 11:16:49.408 +07:00 [INF] Using explicitly configured authentication scheme Identity.Application for IdentityServer
2022-05-24 11:16:49.409 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for authentication
2022-05-24 11:16:49.410 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2022-05-24 11:16:49.411 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2022-05-24 11:16:49.411 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for challenge
2022-05-24 11:16:49.412 +07:00 [DBG] Using IdentityServerJwt as default ASP.NET Core scheme for forbid
2022-05-24 11:16:50.577 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2022-05-24 11:16:50.578 +07:00 [INF] Hosting environment: Development
2022-05-24 11:16:50.578 +07:00 [INF] Content root path: D:\My Projects\Clean-Architecture\CleanArchitecture-main\src\WebUI
2022-05-24 11:16:51.745 +07:00 [DBG] Login Url: /Identity/Account/Login
2022-05-24 11:16:51.749 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2022-05-24 11:16:51.749 +07:00 [DBG] Logout Url: /Identity/Account/Logout
2022-05-24 11:16:51.749 +07:00 [DBG] ConsentUrl Url: /consent
2022-05-24 11:16:51.750 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2022-05-24 11:16:51.750 +07:00 [DBG] Error Url: /Home
2022-05-24 11:16:51.750 +07:00 [DBG] Error Id Parameter: errorId
2022-05-24 11:18:04.539 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2022-05-24 11:18:04.744 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: Duende.IdentityServer.Endpoints.DiscoveryEndpoint
2022-05-24 11:18:04.746 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-05-24 11:18:04.752 +07:00 [DBG] Start discovery request
2022-05-24 11:18:04.810 +07:00 [DBG] Getting all the keys.
2022-05-24 11:18:04.818 +07:00 [DBG] Cache miss when loading all keys.
2022-05-24 11:18:04.824 +07:00 [DBG] Loading keys from store.
2022-05-24 11:18:05.429 +07:00 [DBG] Keys successfully returned from store.
2022-05-24 11:18:05.433 +07:00 [DBG] Caching keys with InitializationKeyCacheDuration for "00:01:00"
2022-05-24 11:18:05.447 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:05.449 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:05.456 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:05.456 +07:00 [DBG] No active signing key found (ignoring the activation delay).
2022-05-24 11:18:05.456 +07:00 [DBG] Failed to find active signing key for alg RS256.
2022-05-24 11:18:05.457 +07:00 [DBG] Entering new key lock.
2022-05-24 11:18:05.458 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:18:05.458 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:05.459 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:05.459 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:05.459 +07:00 [DBG] No active signing key found (ignoring the activation delay).
2022-05-24 11:18:05.459 +07:00 [DBG] Failed to find active signing key for alg RS256.
2022-05-24 11:18:05.460 +07:00 [DBG] Loading keys from store.
2022-05-24 11:18:05.481 +07:00 [DBG] Keys successfully returned from store.
2022-05-24 11:18:05.482 +07:00 [DBG] Caching keys with InitializationKeyCacheDuration for "00:01:00"
2022-05-24 11:18:05.482 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:05.482 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:05.483 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:05.483 +07:00 [DBG] No active signing key found (ignoring the activation delay).
2022-05-24 11:18:05.483 +07:00 [DBG] Failed to find active signing key for alg RS256.
2022-05-24 11:18:05.483 +07:00 [DBG] No active keys; new key creation required.
2022-05-24 11:18:05.503 +07:00 [DBG] Creating new key.
2022-05-24 11:18:07.032 +07:00 [INF] Created and stored new key with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:07.037 +07:00 [DBG] All keys are new; delaying before reloading keys from store by InitializationSynchronizationDelay for "00:00:05".
2022-05-24 11:18:12.044 +07:00 [DBG] Loading keys from store.
2022-05-24 11:18:12.066 +07:00 [DBG] Keys successfully returned from store.
2022-05-24 11:18:12.067 +07:00 [DBG] Caching keys with InitializationKeyCacheDuration for "00:01:00"
2022-05-24 11:18:12.067 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:12.068 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:12.068 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:12.072 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:12.072 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:12.073 +07:00 [DBG] Releasing new key lock.
2022-05-24 11:18:12.136 +07:00 [DBG] Getting the current key.
2022-05-24 11:18:12.137 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:18:12.137 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:12.137 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:12.137 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:12.137 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:12.138 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:12.148 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:12.148 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:12.149 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:53"
2022-05-24 11:18:12.150 +07:00 [INF] Active signing key found with kid 8965CB419F570274991FB1BA3353E7E5 for alg RS256. Expires in "89.23:59:53". Retires in "103.23:59:53"
2022-05-24 11:18:12.254 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2022-05-24 11:18:12.308 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2022-05-24 11:18:12.309 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2022-05-24 11:18:12.313 +07:00 [DBG] Start authorize request
2022-05-24 11:18:12.353 +07:00 [DBG] No user present in authorize request
2022-05-24 11:18:12.359 +07:00 [DBG] Start authorize request protocol validation
2022-05-24 11:18:12.393 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:12.427 +07:00 [DBG] Checking for PKCE parameters
2022-05-24 11:18:12.494 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-05-24 11:18:12.536 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"689f2cc368fa490bacf647186e115b34","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"689f2cc368fa490bacf647186e115b34","code_challenge":"5OheqC6qdUCWQSG3nV1V4oU0qmOHNorTB5RjHal4bVg","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 11:18:12.581 +07:00 [INF] Showing login: User is not authenticated
2022-05-24 11:18:12.582 +07:00 [INF] Changing response to LoginRequired: prompt=none was requested
2022-05-24 11:18:12.586 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"689f2cc368fa490bacf647186e115b34","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"689f2cc368fa490bacf647186e115b34","code_challenge":"5OheqC6qdUCWQSG3nV1V4oU0qmOHNorTB5RjHal4bVg","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 11:18:12.601 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","Endpoint":"Authorize","SubjectId":null,"Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"8000002f-0007-ff00-b63f-84710c7967bb","TimeStamp":"2022-05-24T04:18:12.0000000Z","ProcessId":13424,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2022-05-24 11:18:15.498 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2022-05-24 11:18:15.499 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2022-05-24 11:18:15.499 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2022-05-24 11:18:15.499 +07:00 [DBG] Start authorize request
2022-05-24 11:18:15.500 +07:00 [DBG] No user present in authorize request
2022-05-24 11:18:15.500 +07:00 [DBG] Start authorize request protocol validation
2022-05-24 11:18:15.501 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:15.502 +07:00 [DBG] Checking for PKCE parameters
2022-05-24 11:18:15.503 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-05-24 11:18:15.504 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"407311ffdd8d4cd99539cf185e92c94b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"407311ffdd8d4cd99539cf185e92c94b","code_challenge":"LuLoJgWno4FKeHel6FU7CkZdl-a0KUPFJQ2KaQoIf6w","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 11:18:15.504 +07:00 [INF] Showing login: User is not authenticated
2022-05-24 11:18:29.956 +07:00 [DBG] Augmenting SignInContext
2022-05-24 11:18:29.959 +07:00 [DBG] Adding idp claim with value: local
2022-05-24 11:18:29.960 +07:00 [DBG] Adding auth_time claim with value: 1653365909
2022-05-24 11:18:29.998 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2022-05-24 11:18:29.999 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeCallbackEndpoint
2022-05-24 11:18:29.999 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2022-05-24 11:18:30.002 +07:00 [DBG] Start authorize callback request
2022-05-24 11:18:30.003 +07:00 [DBG] User in authorize request: 21e5069d-a790-49de-8b3b-3cc4584d9470
2022-05-24 11:18:30.003 +07:00 [DBG] Start authorize request protocol validation
2022-05-24 11:18:30.004 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:30.004 +07:00 [DBG] Checking for PKCE parameters
2022-05-24 11:18:30.006 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-05-24 11:18:30.013 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"407311ffdd8d4cd99539cf185e92c94b","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"1851013454EAEC684268234D41C0E51E","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"407311ffdd8d4cd99539cf185e92c94b","code_challenge":"LuLoJgWno4FKeHel6FU7CkZdl-a0KUPFJQ2KaQoIf6w","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 11:18:30.102 +07:00 [DBG] Client is configured to not require consent, no consent is required
2022-05-24 11:18:30.110 +07:00 [DBG] Creating Authorization Code Flow response.
2022-05-24 11:18:30.226 +07:00 [DBG] +4BZuELP/CKvTuh9o8W0EWG/sziodD6LDGnUQ1nPdLQ= not found in database
2022-05-24 11:18:30.948 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","Endpoint":"Authorize","SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****C9FC","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"80000002-0000-f900-b63f-84710c7967bb","TimeStamp":"2022-05-24T04:18:30.0000000Z","ProcessId":13424,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-05-24 11:18:30.953 +07:00 [DBG] Authorize endpoint response
{"SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","ClientId":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","State":"407311ffdd8d4cd99539cf185e92c94b","Scope":"CleanArchitecture.WebUIAPI openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2022-05-24 11:18:30.963 +07:00 [DBG] Augmenting SignInContext
2022-05-24 11:18:31.889 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2022-05-24 11:18:31.890 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: Duende.IdentityServer.Endpoints.DiscoveryEndpoint
2022-05-24 11:18:31.890 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-05-24 11:18:31.890 +07:00 [DBG] Start discovery request
2022-05-24 11:18:31.891 +07:00 [DBG] Getting all the keys.
2022-05-24 11:18:31.891 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:18:31.891 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:31.891 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:31.892 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:31.892 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:31.892 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:31.893 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:31.893 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:31.893 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:34"
2022-05-24 11:18:31.894 +07:00 [DBG] Getting the current key.
2022-05-24 11:18:31.895 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:18:31.895 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:31.895 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:31.895 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:31.895 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:31.896 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:31.896 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:31.896 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:31.896 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:34"
2022-05-24 11:18:31.897 +07:00 [INF] Active signing key found with kid 8965CB419F570274991FB1BA3353E7E5 for alg RS256. Expires in "89.23:59:34". Retires in "103.23:59:34"
2022-05-24 11:18:31.912 +07:00 [DBG] Request path /connect/token matched to endpoint type Token
2022-05-24 11:18:31.920 +07:00 [DBG] Endpoint enabled: Token, successfully created handler: Duende.IdentityServer.Endpoints.TokenEndpoint
2022-05-24 11:18:31.920 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.TokenEndpoint for /connect/token
2022-05-24 11:18:31.932 +07:00 [DBG] Start token request.
2022-05-24 11:18:31.941 +07:00 [DBG] Start client validation
2022-05-24 11:18:31.955 +07:00 [DBG] Start parsing Basic Authentication secret
2022-05-24 11:18:31.959 +07:00 [DBG] Start parsing for secret in post body
2022-05-24 11:18:31.959 +07:00 [DBG] client id without secret found
2022-05-24 11:18:31.960 +07:00 [DBG] Parser found secret: PostBodySecretParser
2022-05-24 11:18:31.961 +07:00 [DBG] Secret id found: CleanArchitecture.WebUI
2022-05-24 11:18:31.961 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:31.964 +07:00 [DBG] Public Client - skipping secret validation success
2022-05-24 11:18:31.964 +07:00 [DBG] Client validation success
2022-05-24 11:18:31.977 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"8000000a-0004-fa00-b63f-84710c7967bb","TimeStamp":"2022-05-24T04:18:31.0000000Z","ProcessId":13424,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-05-24 11:18:31.985 +07:00 [DBG] Start token request validation
2022-05-24 11:18:32.000 +07:00 [DBG] Start validation of authorization code token request
2022-05-24 11:18:32.080 +07:00 [DBG] +4BZuELP/CKvTuh9o8W0EWG/sziodD6LDGnUQ1nPdLQ= found in database: true
2022-05-24 11:18:32.129 +07:00 [DBG] removing +4BZuELP/CKvTuh9o8W0EWG/sziodD6LDGnUQ1nPdLQ= persisted grant from database
2022-05-24 11:18:32.209 +07:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2022-05-24 11:18:32.226 +07:00 [DBG] Validation of authorization code token request success
2022-05-24 11:18:32.238 +07:00 [INF] Token request validation success, {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****C9FC","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"CleanArchitecture.WebUI","code":"D87CC5EB563B06D67BFF22C6654D9F22B0437806FB805196DAE3017D4895C9FC","redirect_uri":"https://localhost:44312/authentication/login-callback","code_verifier":"93e885d5ae0f4b1bb45b3099f5d73e037aa3a81a59204d1db53d0a10b4aa8e500e12171992c6490b9b629a7beea91349","grant_type":"authorization_code"},"$type":"TokenRequestValidationLog"}
2022-05-24 11:18:32.260 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:32.298 +07:00 [DBG] Getting claims for access token for client: CleanArchitecture.WebUI
2022-05-24 11:18:32.300 +07:00 [DBG] Getting claims for access token for subject: 21e5069d-a790-49de-8b3b-3cc4584d9470
2022-05-24 11:18:32.952 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:32.969 +07:00 [DBG] Getting claims for identity token for subject: 21e5069d-a790-49de-8b3b-3cc4584d9470 and client: CleanArchitecture.WebUI
2022-05-24 11:18:32.970 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2022-05-24 11:18:32.982 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":null,"Endpoint":"Token","SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****BBWg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****tdMA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000000a-0004-fa00-b63f-84710c7967bb","TimeStamp":"2022-05-24T04:18:32.0000000Z","ProcessId":13424,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-05-24 11:18:32.983 +07:00 [DBG] Token request success.
2022-05-24 11:18:33.204 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2022-05-24 11:18:33.207 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: Duende.IdentityServer.Endpoints.UserInfoEndpoint
2022-05-24 11:18:33.208 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-05-24 11:18:33.218 +07:00 [DBG] Start userinfo request
2022-05-24 11:18:33.223 +07:00 [DBG] Bearer token found in header
2022-05-24 11:18:33.236 +07:00 [DBG] Getting all the keys.
2022-05-24 11:18:33.236 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:18:33.236 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:33.236 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:33.236 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:33.236 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:33.237 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:33.237 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:33.237 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:33.237 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:32"
2022-05-24 11:18:33.302 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:33.307 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:33.323 +07:00 [DBG] Calling into custom token validator: Duende.IdentityServer.Validation.DefaultCustomTokenValidator
2022-05-24 11:18:33.326 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":"EC26DB0062576C7E57C22ECED7AA34C0","Claims":{"iss":"https://localhost:44312","nbf":1653365912,"iat":1653365912,"exp":1653369512,"aud":"CleanArchitecture.WebUIAPI","scope":["CleanArchitecture.WebUIAPI","openid","profile"],"amr":"pwd","client_id":"CleanArchitecture.WebUI","sub":"21e5069d-a790-49de-8b3b-3cc4584d9470","auth_time":1653365909,"idp":"local","sid":"1851013454EAEC684268234D41C0E51E","jti":"EC26DB0062576C7E57C22ECED7AA34C0"},"$type":"TokenValidationLog"}
2022-05-24 11:18:33.340 +07:00 [DBG] Creating userinfo response
2022-05-24 11:18:33.344 +07:00 [DBG] Scopes in access token: CleanArchitecture.WebUIAPI openid profile
2022-05-24 11:18:33.349 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2022-05-24 11:18:33.369 +07:00 [INF] Profile service returned the following claim types: sub preferred_username name
2022-05-24 11:18:33.369 +07:00 [DBG] End userinfo request
2022-05-24 11:18:33.404 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2022-05-24 11:18:33.405 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: Duende.IdentityServer.Endpoints.CheckSessionEndpoint
2022-05-24 11:18:33.405 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.CheckSessionEndpoint for /connect/checksession
2022-05-24 11:18:33.407 +07:00 [DBG] Rendering check session result
2022-05-24 11:18:43.664 +07:00 [INF] Request: GetWeatherForecastsQuery 21e5069d-a790-49de-8b3b-3cc4584d9470 minhnhat2110.hcm06@gmail.com {"$type":"GetWeatherForecastsQuery"}
2022-05-24 11:18:46.424 +07:00 [INF] Request: GetTodosQuery 21e5069d-a790-49de-8b3b-3cc4584d9470 minhnhat2110.hcm06@gmail.com {"$type":"GetTodosQuery"}
2022-05-24 11:18:51.640 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2022-05-24 11:18:51.648 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: Duende.IdentityServer.Endpoints.DiscoveryEndpoint
2022-05-24 11:18:51.649 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-05-24 11:18:51.649 +07:00 [DBG] Start discovery request
2022-05-24 11:18:51.649 +07:00 [DBG] Getting all the keys.
2022-05-24 11:18:51.649 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:18:51.649 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:51.649 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:51.650 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:51.650 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.650 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.650 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:51.651 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.651 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:14"
2022-05-24 11:18:51.653 +07:00 [DBG] Getting the current key.
2022-05-24 11:18:51.653 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:18:51.653 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:51.653 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:51.654 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:51.654 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.654 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.654 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:51.654 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.655 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:14"
2022-05-24 11:18:51.655 +07:00 [INF] Active signing key found with kid 8965CB419F570274991FB1BA3353E7E5 for alg RS256. Expires in "89.23:59:14". Retires in "103.23:59:14"
2022-05-24 11:18:51.698 +07:00 [DBG] Request path /connect/endsession matched to endpoint type EndSession
2022-05-24 11:18:51.699 +07:00 [DBG] Endpoint enabled: EndSession, successfully created handler: Microsoft.AspNetCore.ApiAuthorization.IdentityServer.AutoRedirectEndSessionEndpoint
2022-05-24 11:18:51.699 +07:00 [INF] Invoking IdentityServer endpoint: Microsoft.AspNetCore.ApiAuthorization.IdentityServer.AutoRedirectEndSessionEndpoint for /connect/endsession
2022-05-24 11:18:51.713 +07:00 [DBG] Start end session request validation
2022-05-24 11:18:51.718 +07:00 [DBG] Start identity token validation
2022-05-24 11:18:51.721 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:51.722 +07:00 [DBG] Client found: CleanArchitecture.WebUI / CleanArchitecture.WebUI
2022-05-24 11:18:51.722 +07:00 [DBG] Getting all the keys.
2022-05-24 11:18:51.722 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:18:51.722 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:18:51.723 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:18:51.723 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:51.723 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.723 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.723 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:18:51.724 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:18:51.724 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:14"
2022-05-24 11:18:51.726 +07:00 [DBG] Calling into custom token validator: Duende.IdentityServer.Validation.DefaultCustomTokenValidator
2022-05-24 11:18:51.727 +07:00 [DBG] Token validation success
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"iss":"https://localhost:44312","nbf":1653365912,"iat":1653365912,"exp":1653366212,"aud":"CleanArchitecture.WebUI","amr":"pwd","at_hash":"gcl7BijkH7KcTHTRgZVmNQ","sid":"1851013454EAEC684268234D41C0E51E","sub":"21e5069d-a790-49de-8b3b-3cc4584d9470","auth_time":1653365909,"idp":"local"},"$type":"TokenValidationLog"}
2022-05-24 11:18:51.738 +07:00 [INF] End session request validation success
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","SubjectId":"21e5069d-a790-49de-8b3b-3cc4584d9470","PostLogOutUri":"https://localhost:44312/authentication/logout-callback","State":"3bb9f350a1704ffda64a90921e260fce","Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"https://localhost:44312/authentication/logout-callback","state":"3bb9f350a1704ffda64a90921e260fce"},"$type":"EndSessionRequestValidationLog"}
2022-05-24 11:18:51.741 +07:00 [DBG] SignOutCalled set; processing post-signout session cleanup.
2022-05-24 11:18:51.760 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:18:51.761 +07:00 [DBG] No client back-channel logout URLs
2022-05-24 11:18:57.488 +07:00 [INF] Request: GetWeatherForecastsQuery   {"$type":"GetWeatherForecastsQuery"}
2022-05-24 11:19:02.767 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2022-05-24 11:19:02.768 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: Duende.IdentityServer.Endpoints.DiscoveryEndpoint
2022-05-24 11:19:02.769 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-05-24 11:19:02.769 +07:00 [DBG] Start discovery request
2022-05-24 11:19:02.769 +07:00 [DBG] Getting all the keys.
2022-05-24 11:19:02.770 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:19:02.770 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:19:02.770 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:19:02.770 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:19:02.771 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:19:02.771 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:19:02.772 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:19:02.772 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:19:02.772 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:03"
2022-05-24 11:19:02.773 +07:00 [DBG] Getting the current key.
2022-05-24 11:19:02.773 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 11:19:02.773 +07:00 [DBG] Looking for active signing keys.
2022-05-24 11:19:02.773 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 11:19:02.773 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:19:02.773 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:19:02.774 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:19:02.774 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 11:19:02.774 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 11:19:02.774 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.23:59:03"
2022-05-24 11:19:02.775 +07:00 [INF] Active signing key found with kid 8965CB419F570274991FB1BA3353E7E5 for alg RS256. Expires in "89.23:59:03". Retires in "103.23:59:03"
2022-05-24 11:19:02.806 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2022-05-24 11:19:02.832 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2022-05-24 11:19:02.833 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2022-05-24 11:19:02.833 +07:00 [DBG] Start authorize request
2022-05-24 11:19:02.833 +07:00 [DBG] No user present in authorize request
2022-05-24 11:19:02.833 +07:00 [DBG] Start authorize request protocol validation
2022-05-24 11:19:02.833 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:19:02.834 +07:00 [DBG] Checking for PKCE parameters
2022-05-24 11:19:02.834 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-05-24 11:19:02.834 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"282b63c4d5be483fbd9e8c4c39dbaa1d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"282b63c4d5be483fbd9e8c4c39dbaa1d","code_challenge":"GcNtQoxglsK7H5dm8gikuDoAbqdKHpXGoEkFMq4QJI4","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 11:19:02.835 +07:00 [INF] Showing login: User is not authenticated
2022-05-24 11:19:02.835 +07:00 [INF] Changing response to LoginRequired: prompt=none was requested
2022-05-24 11:19:02.835 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"282b63c4d5be483fbd9e8c4c39dbaa1d","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"282b63c4d5be483fbd9e8c4c39dbaa1d","code_challenge":"GcNtQoxglsK7H5dm8gikuDoAbqdKHpXGoEkFMq4QJI4","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 11:19:02.836 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","Endpoint":"Authorize","SubjectId":null,"Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"80000010-0004-fb00-b63f-84710c7967bb","TimeStamp":"2022-05-24T04:19:02.0000000Z","ProcessId":13424,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2022-05-24 11:19:03.560 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2022-05-24 11:19:03.562 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2022-05-24 11:19:03.562 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2022-05-24 11:19:03.562 +07:00 [DBG] Start authorize request
2022-05-24 11:19:03.562 +07:00 [DBG] No user present in authorize request
2022-05-24 11:19:03.562 +07:00 [DBG] Start authorize request protocol validation
2022-05-24 11:19:03.563 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 11:19:03.563 +07:00 [DBG] Checking for PKCE parameters
2022-05-24 11:19:03.564 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-05-24 11:19:03.564 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"1d4acc63daef4455ae5781986409e7f5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"1d4acc63daef4455ae5781986409e7f5","code_challenge":"-p1ze3TmUb-0jq58nEW3f1guGplaayyWgf6Tpnr6DXI","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 11:19:03.564 +07:00 [INF] Showing login: User is not authenticated
2022-05-24 11:19:36.079 +07:00 [INF] Request: GetWeatherForecastsQuery   {"$type":"GetWeatherForecastsQuery"}
2022-05-24 11:32:22.117 +07:00 [INF] Request: GetWeatherForecastsQuery   {"$type":"GetWeatherForecastsQuery"}
2022-05-24 11:36:12.580 +07:00 [INF] Request: GetWeatherForecastsQuery   {"$type":"GetWeatherForecastsQuery"}
2022-05-24 15:19:54.692 +07:00 [INF] Request: GetWeatherForecastsQuery   {"$type":"GetWeatherForecastsQuery"}
2022-05-24 15:40:05.678 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2022-05-24 15:40:05.690 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: Duende.IdentityServer.Endpoints.DiscoveryEndpoint
2022-05-24 15:40:05.691 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-05-24 15:40:05.693 +07:00 [DBG] Start discovery request
2022-05-24 15:40:05.695 +07:00 [DBG] Getting all the keys.
2022-05-24 15:40:05.695 +07:00 [DBG] Cache miss when loading all keys.
2022-05-24 15:40:05.697 +07:00 [DBG] Loading keys from store.
2022-05-24 15:40:06.134 +07:00 [DBG] Keys successfully returned from store.
2022-05-24 15:40:06.135 +07:00 [DBG] Caching keys with KeyCacheDuration for "1.00:00:00"
2022-05-24 15:40:06.135 +07:00 [DBG] Looking for active signing keys.
2022-05-24 15:40:06.135 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 15:40:06.136 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 15:40:06.136 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 15:40:06.136 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 15:40:06.136 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 15:40:06.136 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 15:40:06.137 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.19:37:59"
2022-05-24 15:40:06.143 +07:00 [DBG] Getting the current key.
2022-05-24 15:40:06.143 +07:00 [DBG] Cache hit when loading all keys.
2022-05-24 15:40:06.143 +07:00 [DBG] Looking for active signing keys.
2022-05-24 15:40:06.143 +07:00 [DBG] Looking for an active signing key for alg RS256.
2022-05-24 15:40:06.143 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 15:40:06.144 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 15:40:06.144 +07:00 [DBG] Found active signing key for alg RS256 with kid 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 15:40:06.144 +07:00 [DBG] No active signing key found (respecting the activation delay).
2022-05-24 15:40:06.144 +07:00 [DBG] Active signing key found (ignoring the activation delay) with kid: 8965CB419F570274991FB1BA3353E7E5.
2022-05-24 15:40:06.144 +07:00 [DBG] Key rotation not required for alg RS256; New key expected to be created in "75.19:37:59"
2022-05-24 15:40:06.144 +07:00 [INF] Active signing key found with kid 8965CB419F570274991FB1BA3353E7E5 for alg RS256. Expires in "89.19:37:59". Retires in "103.19:37:59"
2022-05-24 15:40:06.180 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2022-05-24 15:40:06.181 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2022-05-24 15:40:06.182 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2022-05-24 15:40:06.182 +07:00 [DBG] Start authorize request
2022-05-24 15:40:06.183 +07:00 [DBG] No user present in authorize request
2022-05-24 15:40:06.184 +07:00 [DBG] Start authorize request protocol validation
2022-05-24 15:40:06.185 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 15:40:06.185 +07:00 [DBG] Checking for PKCE parameters
2022-05-24 15:40:06.187 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-05-24 15:40:06.188 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"12c9c07658d44ee3ae3b5bde4703647a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"12c9c07658d44ee3ae3b5bde4703647a","code_challenge":"EengY48iYwHUjP_8rAHFVjeLZc_bsT2k0KcDSo5TheM","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 15:40:06.188 +07:00 [INF] Showing login: User is not authenticated
2022-05-24 15:40:06.189 +07:00 [INF] Changing response to LoginRequired: prompt=none was requested
2022-05-24 15:40:06.189 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"12c9c07658d44ee3ae3b5bde4703647a","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"none","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"12c9c07658d44ee3ae3b5bde4703647a","code_challenge":"EengY48iYwHUjP_8rAHFVjeLZc_bsT2k0KcDSo5TheM","code_challenge_method":"S256","prompt":"none","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 15:40:06.190 +07:00 [INF] {"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","Endpoint":"Authorize","SubjectId":null,"Scopes":"CleanArchitecture.WebUIAPI openid profile","GrantType":"authorization_code","Error":"login_required","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"8000005e-0005-fb00-b63f-84710c7967bb","TimeStamp":"2022-05-24T08:40:06.0000000Z","ProcessId":13424,"LocalIpAddress":"::1:44312","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2022-05-24 15:40:09.529 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2022-05-24 15:40:09.530 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2022-05-24 15:40:09.531 +07:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2022-05-24 15:40:09.531 +07:00 [DBG] Start authorize request
2022-05-24 15:40:09.532 +07:00 [DBG] No user present in authorize request
2022-05-24 15:40:09.532 +07:00 [DBG] Start authorize request protocol validation
2022-05-24 15:40:09.532 +07:00 [DBG] client configuration validation for client CleanArchitecture.WebUI succeeded.
2022-05-24 15:40:09.533 +07:00 [DBG] Checking for PKCE parameters
2022-05-24 15:40:09.534 +07:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2022-05-24 15:40:09.536 +07:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"CleanArchitecture.WebUI","ClientName":"CleanArchitecture.WebUI","RedirectUri":"https://localhost:44312/authentication/login-callback","AllowedRedirectUris":["/authentication/login-callback"],"SubjectId":"anonymous","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"CleanArchitecture.WebUIAPI openid profile","State":"c6d9bf1e942e4c63acc6f9d37a9e345e","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"CleanArchitecture.WebUI","redirect_uri":"https://localhost:44312/authentication/login-callback","response_type":"code","scope":"CleanArchitecture.WebUIAPI openid profile","state":"c6d9bf1e942e4c63acc6f9d37a9e345e","code_challenge":"4K6GrNVCPuhVBfLQY6nAoC4eu3GMdZFIe5z3sGNEUtU","code_challenge_method":"S256","response_mode":"query"},"$type":"AuthorizeRequestValidationLog"}
2022-05-24 15:40:09.537 +07:00 [INF] Showing login: User is not authenticated
